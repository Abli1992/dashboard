"use strict";(self.webpackChunkthc_dashboard_final=self.webpackChunkthc_dashboard_final||[]).push([[80],{3080:(I,d,r)=>{r.r(d),r.d(d,{FeatureManagementComponent:()=>j});var e=r(4438),l=r(177),c=r(4341),u=r(1562);const _=(n,s)=>({"bg-green-100 text-green-700":n,"bg-gray-200 text-gray-600":s});function p(n,s){if(1&n){const t=e.RV6();e.j41(0,"button",8),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.selectedClientId.set(null))}),e.EFF(1," Change Client "),e.k0s()}}function g(n,s){if(1&n&&(e.j41(0,"option",14),e.EFF(1),e.k0s()),2&n){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.Lme(" ",t.name," (",t.clientCode,") ")}}function m(n,s){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"div",9)(2,"label",10),e.EFF(3,"Select Client"),e.k0s(),e.j41(4,"select",11),e.bIt("change",function(a){e.eBV(t);const o=e.XpG();return e.Njj(o.onClientChange(a))}),e.j41(5,"option",12),e.EFF(6,"Choose a client to manage features"),e.k0s(),e.DNE(7,g,2,3,"option",13),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(7),e.Y8G("ngForOf",t.clients())}}function f(n,s){1&n&&(e.j41(0,"div",15),e.EFF(1,"Loading features..."),e.k0s())}function v(n,s){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"div",16)(2,"h2",17),e.EFF(3,"Initialize Features"),e.k0s(),e.j41(4,"p",18),e.EFF(5," This client doesn\u2019t have any feature settings yet. Click below to initialize defaults. "),e.k0s(),e.j41(6,"button",19),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.initializeFeatures())}),e.EFF(7," + Initialize Default Features "),e.k0s()()()}}function h(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",26)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"div",27)(4,"span",28),e.EFF(5),e.k0s(),e.j41(6,"input",29),e.bIt("change",function(){const a=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.toggleFeature(o.getFeature(a.key,"recovery_type")))}),e.k0s()()()}if(2&n){const t=s.$implicit,i=e.XpG(3);e.R7$(2),e.JRh(t.name),e.R7$(2),e.Y8G("ngClass",e.l_i(4,_,i.getFeatureStatus(t.key,"recovery_type"),!i.getFeatureStatus(t.key,"recovery_type"))),e.R7$(),e.SpI(" ",i.getFeatureStatus(t.key,"recovery_type")?"Y":"N"," "),e.R7$(),e.Y8G("checked",i.getFeatureStatus(t.key,"recovery_type"))}}function b(n,s){if(1&n&&(e.j41(0,"div",24),e.DNE(1,h,7,7,"div",25),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.RECOVERY_TYPES)}}function F(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",20)(1,"div",21),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.toggleSection("recovery"))}),e.j41(2,"h2",22),e.EFF(3,"Recovery Types"),e.k0s(),e.nrm(4,"i"),e.k0s(),e.DNE(5,b,2,1,"div",23),e.k0s()}if(2&n){const t=e.XpG();e.R7$(4),e.HbH(t.expanded().recovery?"bi bi-chevron-up":"bi bi-chevron-down"),e.R7$(),e.Y8G("ngIf",t.expanded().recovery)}}function k(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",26)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"div",27)(4,"span",28),e.EFF(5),e.k0s(),e.j41(6,"input",29),e.bIt("change",function(){const a=e.eBV(t).$implicit,o=e.XpG(3);return e.Njj(o.toggleFeature(o.getFeature(a.key,"marketplace")))}),e.k0s()()()}if(2&n){const t=s.$implicit,i=e.XpG(3);e.R7$(2),e.JRh(t.name),e.R7$(2),e.Y8G("ngClass",e.l_i(4,_,i.getFeatureStatus(t.key,"marketplace"),!i.getFeatureStatus(t.key,"marketplace"))),e.R7$(),e.SpI(" ",i.getFeatureStatus(t.key,"marketplace")?"Active":"Disabled"," "),e.R7$(),e.Y8G("checked",i.getFeatureStatus(t.key,"marketplace"))}}function C(n,s){if(1&n&&(e.j41(0,"div",24),e.DNE(1,k,7,7,"div",25),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.MARKETPLACES)}}function y(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",20)(1,"div",21),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.toggleSection("marketplace"))}),e.j41(2,"h2",22),e.EFF(3,"Marketplaces"),e.k0s(),e.nrm(4,"i"),e.k0s(),e.DNE(5,C,2,1,"div",23),e.k0s()}if(2&n){const t=e.XpG();e.R7$(4),e.HbH(t.expanded().marketplace?"bi bi-chevron-up":"bi bi-chevron-down"),e.R7$(),e.Y8G("ngIf",t.expanded().marketplace)}}function x(n,s){if(1&n&&(e.j41(0,"div",33)(1,"p",34),e.EFF(2),e.k0s(),e.j41(3,"p",35),e.EFF(4),e.nI1(5,"date"),e.k0s()()),2&n){const t=s.$implicit;e.R7$(2),e.JRh(t.note),e.R7$(2),e.SpI(" ",e.i5U(5,2,t.createdAt,"short")," ")}}function E(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",24)(1,"textarea",30),e.bIt("ngModelChange",function(a){e.eBV(t);const o=e.XpG(2);return e.Njj(o.newNote.set(a))}),e.k0s(),e.j41(2,"button",31),e.bIt("click",function(){e.eBV(t);const a=e.XpG(2);return e.Njj(a.addNote())}),e.EFF(3," \u{1f4be} Add Note "),e.k0s(),e.DNE(4,x,6,5,"div",32),e.k0s()}if(2&n){const t=e.XpG(2);e.R7$(),e.Y8G("ngModel",t.newNote()),e.R7$(),e.Y8G("disabled",!t.newNote().trim()),e.R7$(2),e.Y8G("ngForOf",t.notes())}}function R(n,s){if(1&n){const t=e.RV6();e.j41(0,"div",20)(1,"div",21),e.bIt("click",function(){e.eBV(t);const a=e.XpG();return e.Njj(a.toggleSection("notes"))}),e.j41(2,"h2",22),e.EFF(3,"Notes"),e.k0s(),e.nrm(4,"i"),e.k0s(),e.DNE(5,E,5,3,"div",23),e.k0s()}if(2&n){const t=e.XpG();e.R7$(4),e.HbH(t.expanded().notes?"bi bi-chevron-up":"bi bi-chevron-down"),e.R7$(),e.Y8G("ngIf",t.expanded().notes)}}let j=(()=>{class n{constructor(){this.http=(0,e.WQX)(u.Qq),this.clients=(0,e.vPA)([]),this.features=(0,e.vPA)([]),this.notes=(0,e.vPA)([]),this.selectedClientId=(0,e.vPA)(null),this.newNote=(0,e.vPA)(""),this.loading=(0,e.vPA)(!1),this.expanded=(0,e.vPA)({recovery:!0,marketplace:!0,notes:!1}),this.RECOVERY_TYPES=[{name:"Overbilling",key:"overbilling"},{name:"Aged Shortages",key:"aged_shortages"},{name:"Current Shortages",key:"current_shortages"},{name:"Current Price Claims",key:"current_price_claims"},{name:"Missing Invoices",key:"missing_invoices"},{name:"Audits",key:"audits"}],this.MARKETPLACES=[{name:"Amazon",key:"amazon"},{name:"Walmart",key:"walmart"},{name:"Home Depot",key:"homedepot"}],this.loadClients()}loadClients(){this.http.get("/api/clients").subscribe(t=>this.clients.set(t||[]))}loadClientData(){const t=this.selectedClientId();t&&(this.loading.set(!0),this.http.get(`/api/client-features/${t}`).subscribe(i=>{this.features.set(i||[]),this.loading.set(!1)}),this.http.get(`/api/client-notes/${t}`).subscribe(i=>{this.notes.set(i||[])}))}initializeFeatures(){const t=this.selectedClientId();if(!t)return;const i=[...this.RECOVERY_TYPES.map(a=>({clientId:t,featureType:"recovery_type",featureName:a.key,isEnabled:!0})),...this.MARKETPLACES.map(a=>({clientId:t,featureType:"marketplace",featureName:a.key,isEnabled:!0}))];this.http.post("/api/client-features/initialize",{features:i}).subscribe(()=>{this.loadClientData()})}toggleFeature(t){this.http.put(`/api/client-features/${t.id}`,{isEnabled:!t.isEnabled}).subscribe(()=>{t.isEnabled=!t.isEnabled})}addNote(){const t=this.newNote().trim(),i=this.selectedClientId();!t||!i||this.http.post("/api/client-notes",{clientId:i,note:t}).subscribe(()=>{this.newNote.set(""),this.loadClientData()})}getFeatureStatus(t,i){return this.features().find(o=>o.featureName===t&&o.featureType===i)?.isEnabled??!1}getFeature(t,i){return this.features().find(a=>a.featureName===t&&a.featureType===i)}toggleSection(t){const i={...this.expanded()};i[t]=!i[t],this.expanded.set(i)}onClientChange(t){const a=+t.target.value;isNaN(a)||(this.selectedClientId.set(a),this.loadClientData())}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-feature-management"]],standalone:!0,features:[e.aNF],decls:12,vars:7,consts:[[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","flex","items-center","gap-2"],[1,"bi","bi-gear"],["class","border px-3 py-1 rounded-md text-sm",3,"click",4,"ngIf"],[4,"ngIf"],["class","text-center text-gray-500 py-8",4,"ngIf"],["class","bg-white border rounded-lg",4,"ngIf"],[1,"border","px-3","py-1","rounded-md","text-sm",3,"click"],[1,"bg-white","rounded-lg","p-4","border"],[1,"font-semibold","block","mb-2"],[1,"w-full","border","rounded-lg","p-2",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text-center","text-gray-500","py-8"],[1,"bg-white","p-6","border","rounded-lg"],[1,"font-bold","text-lg","mb-2"],[1,"text-gray-500","mb-4"],[1,"bg-blue-600","text-white","px-4","py-2","rounded",3,"click"],[1,"bg-white","border","rounded-lg"],[1,"flex","items-center","justify-between","px-4","py-3","cursor-pointer","border-b",3,"click"],[1,"font-semibold"],["class","p-4 space-y-3",4,"ngIf"],[1,"p-4","space-y-3"],["class","flex items-center justify-between border-b pb-2",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","border-b","pb-2"],[1,"flex","items-center","gap-2"],[1,"px-2","py-1","text-xs","rounded",3,"ngClass"],["type","checkbox",1,"accent-yellow-500",3,"change","checked"],["placeholder","Add a note...",1,"w-full","border","rounded-lg","p-2","min-h-[80px]",3,"ngModelChange","ngModel"],[1,"bg-yellow-500","text-white","px-4","py-2","rounded",3,"click","disabled"],["class","bg-yellow-100 p-3 rounded-lg",4,"ngFor","ngForOf"],[1,"bg-yellow-100","p-3","rounded-lg"],[1,"text-sm"],[1,"text-xs","text-gray-500"]],template:function(i,a){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.nrm(3,"i",3),e.EFF(4," Feature Management "),e.k0s(),e.DNE(5,p,2,0,"button",4),e.k0s(),e.DNE(6,m,8,1,"div",5)(7,f,2,0,"div",6)(8,v,8,0,"div",5)(9,F,6,3,"div",7)(10,y,6,3,"div",7)(11,R,6,3,"div",7),e.k0s()),2&i&&(e.R7$(5),e.Y8G("ngIf",a.selectedClientId()),e.R7$(),e.Y8G("ngIf",!a.selectedClientId()),e.R7$(),e.Y8G("ngIf",a.loading()),e.R7$(),e.Y8G("ngIf",a.selectedClientId()&&!a.loading()&&0===a.features().length),e.R7$(),e.Y8G("ngIf",a.features().length>0),e.R7$(),e.Y8G("ngIf",a.features().length>0),e.R7$(),e.Y8G("ngIf",a.features().length>0))},dependencies:[l.MD,l.YU,l.Sq,l.bT,l.vh,c.YN,c.xH,c.y7,c.me,c.BC,c.vS]})}}return n})()}}]);